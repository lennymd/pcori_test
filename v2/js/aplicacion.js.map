{"version":3,"sources":["setup.js","diccionario.js","puntos.js","main.js"],"names":[],"mappings":"AAAA;AACA;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1wDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"aplicacion.js","sourcesContent":["\"use strict\";\r\n","var diccionario = {\r\n  filters: {\r\n    target_social_need: {\r\n      options: [\r\n        {\r\n          value: \"Childcare\",\r\n        },\r\n        {\r\n          label0: \"Early childhood development\",\r\n          value: \"Early childhood education and development\",\r\n        },\r\n        {\r\n          value: \"Education\",\r\n        },\r\n        {\r\n          value: \"Employment\",\r\n        },\r\n        {\r\n          value: \"Financial strain\",\r\n        },\r\n        {\r\n          value: \"Food insecurity\",\r\n        },\r\n        {\r\n          value: \"Healthcare services\",\r\n        },\r\n        {\r\n          value: \"Housing instability/quality\",\r\n        },\r\n        {\r\n          value: \"Interpersonal violence\",\r\n        },\r\n        {\r\n          value: \"Legal services\",\r\n        },\r\n        {\r\n          value: \"Social isolation\",\r\n        },\r\n        {\r\n          value: \"Transportation help\",\r\n        },\r\n        {\r\n          value: \"Utilities help\",\r\n        },\r\n        {\r\n          value: \"Multiple domains addressed\",\r\n        },\r\n      ],\r\n    },\r\n    target_population: {\r\n      options: [\r\n        {\r\n          value: \"Frequent users of healthcare services\",\r\n        },\r\n        {\r\n          value: \"Homeless persons\",\r\n        },\r\n        {\r\n          value: \"Medicare/Medicaid enrollees (or eligible)\",\r\n        },\r\n        {\r\n          value: \"Persons living in low-income neighborhood\",\r\n        },\r\n        {\r\n          value: \"Persons meeting specific medical criteria\",\r\n        },\r\n        {\r\n          value: \"Persons with low income\",\r\n        },\r\n        {\r\n          value: \"Pregnant persons\",\r\n        },\r\n        {\r\n          value: \"Veterans\",\r\n        },\r\n      ],\r\n    },\r\n    study_design: {\r\n      options: [\r\n        {\r\n          value: \"Case-control\",\r\n        },\r\n        {\r\n          value: \"Cohort study\",\r\n        },\r\n        {\r\n          value: \"Comparative effectiveness within arm pre-post outcome trend\",\r\n        },\r\n        {\r\n          value: \"Pre-post\",\r\n        },\r\n        {\r\n          label0: \"Randomized controlled trial\",\r\n          value: \"RCT\",\r\n        },\r\n        {\r\n          value: \"Other observational\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  columns: {\r\n    age_group: {\r\n      menu: \"Age group\",\r\n      options: [\r\n        {\r\n          value: \"Children (<18 years ) or children and their families\",\r\n        },\r\n        {\r\n          value: \"Adolescents/young adults (e.g., 13-20 years)\",\r\n        },\r\n        {\r\n          value: \"Adults (≥18 years)\",\r\n        },\r\n        {\r\n          value: \"Older adults (e.g., ≥50 years)\",\r\n        },\r\n      ],\r\n    },\r\n    race_ethnicity_majority: {\r\n      menu: \"Majority ethnic/racial group\",\r\n      label: \"Majority ethnic group\",\r\n      options: [\r\n        {\r\n          value: \"Majority Asian/Pacific Islander\",\r\n          label: \"Asian/Pacific Islander\",\r\n        },\r\n        {\r\n          value: \"Majority Black/Non-Hispanic Black\",\r\n          label: \"Non-Hispanic Black\",\r\n        },\r\n        {\r\n          value: \"Majority Hispanic/Latino\",\r\n          label: \"Hispanic\",\r\n        },\r\n        {\r\n          value: \"Majority Native American/American Indian/Indigenous\",\r\n          label: \"\",\r\n        },\r\n        {\r\n          value: \"Majority White/Non-Hispanic White\",\r\n          label: \"Non-Hispanic White\",\r\n        },\r\n        {\r\n          value: \"No single group is a majority\",\r\n        },\r\n        {\r\n          value: \"Not Reported\",\r\n        },\r\n        {\r\n          value: \"Other\",\r\n        },\r\n      ],\r\n    },\r\n    proportion_immigrant: {\r\n      menu: \"Percentage of immigrants\",\r\n      options: [\r\n        {\r\n          range: [0, 100],\r\n          value: \"Immigrant participation\",\r\n        },\r\n      ],\r\n    },\r\n    proportion_male: {\r\n      menu: \"Sex (percentage male)\",\r\n      options: [\r\n        {\r\n          range: [0, 24],\r\n          value: \"0 – 24%\",\r\n        },\r\n        {\r\n          range: [25, 49],\r\n          value: \"25 – 49%\",\r\n        },\r\n        {\r\n          range: [50, 74],\r\n          value: \"50 – 74%\",\r\n        },\r\n        {\r\n          range: [75, 100],\r\n          value: \"75 – 100%\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  rows: {\r\n    addresses_behavioral_outcomes: {\r\n      options: [\r\n        {\r\n          value: \"Yes\",\r\n        },\r\n        {\r\n          value: \"No\",\r\n        },\r\n      ],\r\n    },\r\n    behavioral_outcomes: {\r\n      menu: \"Behavioral\",\r\n      label: \"Behavioral outcomes\",\r\n      options: [\r\n        {\r\n          value: \"Changes in substance use\",\r\n          key: \"result_substance_use\",\r\n        },\r\n        {\r\n          value: \"Changes in dietary intake\",\r\n          key: \"result_diet\",\r\n        },\r\n        {\r\n          value: \"Changes in physical activity\",\r\n          key: \"result_physical_activity\",\r\n        },\r\n        {\r\n          value: \"Other\",\r\n          key: \"result_other_behavior \",\r\n        },\r\n      ],\r\n    },\r\n    addresses_health_outcomes: {\r\n      options: [\r\n        {\r\n          value: \"Yes\",\r\n        },\r\n        {\r\n          value: \"No\",\r\n        },\r\n      ],\r\n    },\r\n    health_outcomes: {\r\n      menu: \"Health\",\r\n      label: \"Health outcomes\",\r\n      options: [\r\n        {\r\n          value: \"Changes in functional outcomes (e.g., blood pressure)\",\r\n          label: \"Changes in functional outcomes\",\r\n          key: \"result_functional\",\r\n        },\r\n        {\r\n          value: \"Changes in self-reported health\",\r\n          key: \"result_self_health\",\r\n        },\r\n        {\r\n          value: \"Child development outcomes\",\r\n          label: \"Child emotional, mental, or physical growth outcomes\",\r\n          key: \"result_child_development\",\r\n        },\r\n        {\r\n          value: \"Low birth weight\",\r\n          key: \"result_low_birth_weight\",\r\n        },\r\n        {\r\n          value: \"Mental health status\",\r\n          key: \"result_mental_health_status\",\r\n        },\r\n        {\r\n          value: \"Mortality\",\r\n          key: \"result_mortality\",\r\n        },\r\n        {\r\n          value: \"Quality of life\",\r\n          key: \"result_quality_of_life\",\r\n        },\r\n        {\r\n          value: \"Quality-adjusted life-years\",\r\n          key: \"result_QALY\",\r\n        },\r\n        {\r\n          value: \"Reduction in morbidity\",\r\n          key: \"result_morbidity\",\r\n        },\r\n        {\r\n          value: \"Other\",\r\n          key: \"result_other_health\",\r\n        },\r\n      ],\r\n    },\r\n    addresses_healthcareuse_outcomes: {\r\n      options: [\r\n        {\r\n          value: \"Yes\",\r\n        },\r\n        {\r\n          value: \"No\",\r\n        },\r\n      ],\r\n    },\r\n    healthcareuse_outcomes: {\r\n      menu: \"Use of healthcare services\",\r\n      options: [\r\n        {\r\n          value: \"Adherence to treatment (medications/follow-up visit)\",\r\n          key: \"result_adherence\",\r\n        },\r\n        {\r\n          value: \"Clinic attendance rate\",\r\n          key: \"result_clinic_attendance\",\r\n        },\r\n        {\r\n          value: \"Emergency department visits/urgent care\",\r\n          key: \"result_emergency_visits\",\r\n        },\r\n        {\r\n          value: \"Frequency of healthcare use\",\r\n          key: \"result_frequency_healthcare_use\",\r\n        },\r\n        {\r\n          value: \"Hospital days\",\r\n          key: \"result_hospital_days\",\r\n        },\r\n        {\r\n          value: \"Hospital readmissions\",\r\n          key: \"result_hospital_readmission\",\r\n        },\r\n        {\r\n          value: \"Immunizations\",\r\n          key: \"result_immunizations\",\r\n        },\r\n        {\r\n          value: \"Inpatient admissions\",\r\n          key: \"result_inpatient_admission\",\r\n        },\r\n        {\r\n          value: \"Medical home\",\r\n          key: \"result_medical_home\",\r\n        },\r\n        {\r\n          value: \"Missed appointments\",\r\n          key: \"result_missed_appt\",\r\n        },\r\n        {\r\n          value: \"Outpatient visits\",\r\n          key: \"result_outpatient_visits\",\r\n        },\r\n        {\r\n          value: \"Post hospital primary care visit\",\r\n          key: \"result_post_primarycare_visits\",\r\n        },\r\n        {\r\n          value: \"Prenatal care\",\r\n          key: \"result_prenatal\",\r\n        },\r\n        {\r\n          value: \"Preventive care utilization (well child visits)\",\r\n          key: \"result_preventive\",\r\n        },\r\n        {\r\n          value: \"Sobering center use\",\r\n          key: \"result_sober_center\",\r\n        },\r\n        {\r\n          value: \"Use of emergency transportation\",\r\n          key: \"result_emergency_transport\",\r\n        },\r\n        {\r\n          value: \"Other\",\r\n          key: \"result_other_healthcareuse\",\r\n        },\r\n      ],\r\n    },\r\n  },\r\n  outcomes: {\r\n    options: [\r\n      {\r\n        value: \"Positive\",\r\n      },\r\n      {\r\n        value: \"Negative\",\r\n      },\r\n      {\r\n        value: \"Mixed results\",\r\n        label: \"Mixed\",\r\n      },\r\n      {\r\n        value: \"Multiple arms\",\r\n      },\r\n      {\r\n        value: \"No significant difference\",\r\n      },\r\n    ],\r\n  },\r\n  switch: {\r\n    quality_rating: {\r\n      menu: \"Study quality\",\r\n      //options: [{ value: \"Study quality\" }],\r\n    },\r\n  },\r\n};\r\n","var Puntos = function (el, i) {\r\n  var debug = false;\r\n  var caja = new Box({\r\n    content: { width: 1000, height: 600 },\r\n    padding: 10,\r\n  });\r\n\r\n  var contenedor = null;\r\n  var svg = null;\r\n  var raiz = null;\r\n\r\n  var gWrapperSuperior = null;\r\n  var gOutcome = null;\r\n  var gStudy = null;\r\n  var gExplicacion = null;\r\n  var gTituloFilas = null;\r\n  var gEncabezadoColumnas = null;\r\n\r\n  var gPrincipal = null;\r\n  var gEncabezadoFilas = null;\r\n  var gCeldas = null;\r\n  var gPuntos = null;\r\n  var gBotones = null;\r\n  var gSeparadores = null;\r\n\r\n  var cajaWrapperSuperior = new Box();\r\n  var cajaOutcome = new Box();\r\n  var cajaStudy = new Box();\r\n  var cajaExplicacion = new Box();\r\n  var cajaTituloFilas = new Box();\r\n  var cajaEncabezadoColumnas = new Box();\r\n\r\n  var cajaPrincipal = new Box();\r\n  var cajaEncabezadoFilas = new Box();\r\n  var cajaPuntos = new Box();\r\n  var cajaBotones = new Box({\r\n    content: { width: 0, height: 20 },\r\n    padding: { top: 5, bottom: 5, left: 0, right: 0 },\r\n  });\r\n  var cajaSeparadores = new Box();\r\n\r\n  var paddingEncabezadoH = 10;\r\n  var paddingEncabezadoV = 5;\r\n  var anchoColumna = 0;\r\n  var anchoColumnaTexto = 0;\r\n\r\n  var puntos = null;\r\n  var opcionesMenu = [];\r\n\r\n  var controles = { filters: null, rows: null, columns: null, switch: null };\r\n\r\n  var maxPuntosPorFila = 20;\r\n\r\n  var filas = 0;\r\n  var columnas = 0;\r\n\r\n  function setup() {\r\n    contenedor = d3.select(el[0]);\r\n    var flag = el.data(\"visualizacion\") || false;\r\n    if (flag === false) {\r\n      el.data(\"visualizacion\", true);\r\n      contenedor.selectAll(\"svg\").remove();\r\n      svg = contenedor\r\n        .append(\"svg\")\r\n        .attr(\"preserveAspectRatio\", \"xMidYMid\")\r\n        .attr(\"viewBox\", [0, 0, caja.outer.width, caja.outer.height]);\r\n\r\n      el.attr(\"data-setup\", true);\r\n\r\n      if (debug === true) {\r\n        svg\r\n          .attr(\"id\", el.data(\"tipo-visualizacion\") + \"-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"fill\", \"yellow\")\r\n          .attr(\"opacity\", 0.5)\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", caja.outer.width)\r\n          .attr(\"height\", caja.outer.height);\r\n      }\r\n\r\n      raiz = svg;\r\n      svg = svg\r\n        .append(\"g\")\r\n        .attr(\r\n          \"transform\",\r\n          \"translate(\" + caja.padding.left + \",\" + caja.padding.top + \")\"\r\n        );\r\n\r\n      if (debug === true) {\r\n        svg\r\n          .attr(\"class\", \"svg\")\r\n          .append(\"rect\")\r\n          .attr(\"width\", caja.content.width)\r\n          .attr(\"height\", caja.content.height)\r\n          .attr(\"fill\", \"blue\")\r\n          .attr(\"opacity\", 0.5);\r\n      }\r\n\r\n      gWrapperSuperior = svg.append(\"g\");\r\n      if (debug === true) {\r\n        gWrapperSuperior\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"yellow\")\r\n          .attr(\"opacity\", 0.5);\r\n      }\r\n\r\n      gStudy = gWrapperSuperior.append(\"g\");\r\n      gOutcome = gWrapperSuperior.append(\"g\");\r\n      gExplicacion = gWrapperSuperior.append(\"g\");\r\n      gTituloFilas = gWrapperSuperior.append(\"g\");\r\n      gEncabezadoColumnas = gWrapperSuperior.append(\"g\");\r\n      gPrincipal = svg.append(\"g\");\r\n      if (debug === true) {\r\n        gPrincipal\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"blue\")\r\n          .attr(\"opacity\", 0.3);\r\n      }\r\n\r\n      gEncabezadoFilas = gPrincipal.append(\"g\");\r\n      gCeldas = gPrincipal.append(\"g\");\r\n      gPuntos = gPrincipal.append(\"g\");\r\n      gBotones = gPrincipal.append(\"g\");\r\n      gSeparadores = gPrincipal.append(\"g\");\r\n\r\n      if (debug === true) {\r\n        gWrapperSuperior.attr(\"id\", \"gWrapperSuperior-\" + i);\r\n        gStudy\r\n          .attr(\"id\", \"gStudy-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"red\")\r\n          .attr(\"opacity\", 0.3);\r\n        gOutcome\r\n          .attr(\"id\", \"gOutcome-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"green\")\r\n          .attr(\"opacity\", 0.3);\r\n        gExplicacion\r\n          .attr(\"id\", \"gExplicacion-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"blue\")\r\n          .attr(\"opacity\", 0.3);\r\n        gTituloFilas\r\n          .attr(\"id\", \"gTituloFilas-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"red\")\r\n          .attr(\"opacity\", 0.3);\r\n        gEncabezadoColumnas\r\n          .attr(\"id\", \"gEncabezadoColumnas-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"green\")\r\n          .attr(\"opacity\", 0.3);\r\n        gPrincipal.attr(\"id\", \"gPrincipal-\" + i);\r\n        gEncabezadoFilas\r\n          .attr(\"id\", \"gEncabezadoFilas-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"red\")\r\n          .attr(\"opacity\", 0.3);\r\n        gCeldas.attr(\"id\", \"gCeldas-\" + i);\r\n        gPuntos\r\n          .attr(\"id\", \"gPuntos-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"green\")\r\n          .attr(\"opacity\", 0.3);\r\n        gBotones.attr(\"id\", \"gBotones-\" + i);\r\n        gSeparadores\r\n          .attr(\"id\", \"gSeparadores-\" + i)\r\n          .append(\"rect\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"width\", 0)\r\n          .attr(\"fill\", \"blue\")\r\n          .attr(\"opacity\", 0.3);\r\n      }\r\n\r\n      var articulosURL = \"csv/\" + el.data(\"articulos\") + \".csv\";\r\n\r\n      var promesas = [];\r\n\r\n      promesas.push(\r\n        d3.csv(articulosURL, function (d, i) {\r\n          return {\r\n            id: d.Refid + \":\" + i,\r\n            ref_id: +d.Refid,\r\n            study_name: limpiaCadena(d.study_name),\r\n            title: limpiaCadena(d.title),\r\n            age_group: convierteCadenaAArreglo(d.age_group),\r\n            addresses_behavioral_outcomes: convierteCadenaABooleano(\r\n              d.addresses_behavioral_outcomes\r\n            ),\r\n            behavioral_outcomes: convierteCadenaAArreglo(\r\n              d.behavioral_outcomes,\r\n              true\r\n            ),\r\n            result_diet: convierteCadenaAResultados(\r\n              d.result_diet,\r\n              diccionario.outcomes\r\n            ),\r\n            result_substance_use: convierteCadenaAResultados(\r\n              d.result_substance_use,\r\n              diccionario.outcomes\r\n            ),\r\n            result_physical_activity: convierteCadenaAResultados(\r\n              d.result_physical_activity,\r\n              diccionario.outcomes\r\n            ),\r\n            result_other_behavior: convierteCadenaAResultados(\r\n              d.result_other_behavior,\r\n              diccionario.outcomes\r\n            ),\r\n            addresses_health_outcomes: convierteCadenaABooleano(\r\n              d.addresses_health_outcomes\r\n            ),\r\n            health_outcomes: convierteCadenaAArreglo(d.health_outcomes, true),\r\n            result_functional: convierteCadenaAResultados(\r\n              d.result_functional,\r\n              diccionario.outcomes\r\n            ),\r\n            result_self_health: convierteCadenaAResultados(\r\n              d.result_self_health,\r\n              diccionario.outcomes\r\n            ),\r\n            result_child_development: convierteCadenaAResultados(\r\n              d.result_child_development,\r\n              diccionario.outcomes\r\n            ),\r\n            result_low_birth_weight: convierteCadenaAResultados(\r\n              d.result_low_birth_weight,\r\n              diccionario.outcomes\r\n            ),\r\n            result_mental_health_status: convierteCadenaAResultados(\r\n              d.result_mental_health_status,\r\n              diccionario.outcomes\r\n            ),\r\n            result_mortality: convierteCadenaAResultados(\r\n              d.result_mortality,\r\n              diccionario.outcomes\r\n            ),\r\n            result_other_health: convierteCadenaAResultados(\r\n              d.result_other_health,\r\n              diccionario.outcomes\r\n            ),\r\n            result_quality_of_life: convierteCadenaAResultados(\r\n              d.result_quality_of_life,\r\n              diccionario.outcomes\r\n            ),\r\n            result_QALY: convierteCadenaAResultados(\r\n              d.result_QALY,\r\n              diccionario.outcomes\r\n            ),\r\n            result_morbidity: convierteCadenaAResultados(\r\n              d.result_morbidity,\r\n              diccionario.outcomes\r\n            ),\r\n            addresses_healthcareuse_outcomes: convierteCadenaABooleano(\r\n              d.addresses_healthcareuse_outcomes\r\n            ),\r\n            healthcareuse_outcomes: convierteCadenaAArreglo(\r\n              d.healthcareuse_outcomes,\r\n              true\r\n            ),\r\n            result_adherence: convierteCadenaAResultados(\r\n              d.result_adherence,\r\n              diccionario.outcomes\r\n            ),\r\n            result_clinic_attendance: convierteCadenaAResultados(\r\n              d.result_clinic_attendance,\r\n              diccionario.outcomes\r\n            ),\r\n            result_emergency_visits: convierteCadenaAResultados(\r\n              d.result_emergency_visits,\r\n              diccionario.outcomes\r\n            ),\r\n            result_frequency_healthcare_use: convierteCadenaAResultados(\r\n              d.result_frequency_healthcare_use,\r\n              diccionario.outcomes\r\n            ),\r\n            result_hospital_days: convierteCadenaAResultados(\r\n              d.result_hospital_days,\r\n              diccionario.outcomes\r\n            ),\r\n            result_hospital_readmission: convierteCadenaAResultados(\r\n              d.result_hospital_readmission,\r\n              diccionario.outcomes\r\n            ),\r\n            result_immunizations: convierteCadenaAResultados(\r\n              d.result_immunizations,\r\n              diccionario.outcomes\r\n            ),\r\n            result_inpatient_admission: convierteCadenaAResultados(\r\n              d.result_inpatient_admission,\r\n              diccionario.outcomes\r\n            ),\r\n            result_medical_home: convierteCadenaAResultados(\r\n              d.result_medical_home,\r\n              diccionario.outcomes\r\n            ),\r\n            result_missed_appointmentst: convierteCadenaAResultados(\r\n              d.result_missed_appointmentst,\r\n              diccionario.outcomes\r\n            ),\r\n            result_other_healthcareuse: convierteCadenaAResultados(\r\n              d.result_other_healthcareuse,\r\n              diccionario.outcomes\r\n            ),\r\n            result_outpatient_visits: convierteCadenaAResultados(\r\n              d.result_outpatient_visits,\r\n              diccionario.outcomes\r\n            ),\r\n            result_post_primarycare_visits: convierteCadenaAResultados(\r\n              d.result_post_primarycare_visits,\r\n              diccionario.outcomes\r\n            ),\r\n            result_prenatal: convierteCadenaAResultados(\r\n              d.result_prenatal,\r\n              diccionario.outcomes\r\n            ),\r\n            result_preventive: convierteCadenaAResultados(\r\n              d.result_preventive,\r\n              diccionario.outcomes\r\n            ),\r\n            result_sober_center: convierteCadenaAResultados(\r\n              d.result_sober_center,\r\n              diccionario.outcomes\r\n            ),\r\n            result_emergency_transport: convierteCadenaAResultados(\r\n              d.result_emergency_transport,\r\n              diccionario.outcomes\r\n            ),\r\n            proportion_immigrant: convierteCadenaARangos(\r\n              d.proportion_immigrant,\r\n              diccionario.columns.proportion_immigrant\r\n            ),\r\n            proportion_male: convierteCadenaARangos(\r\n              d.proportion_male,\r\n              diccionario.columns.proportion_male\r\n            ),\r\n            race_ethnicity_majority: limpiaCadena(d.race_ethnicity_majority),\r\n            risk_of_bias: limpiaCadena(d.risk_of_bias),\r\n            study_design: limpiaCadena(d.study_design),\r\n            target_population: convierteCadenaAArreglo(d.target_population),\r\n            target_social_need: convierteCadenaAArreglo(d.target_social_need),\r\n            quality_rating: limpiaCadena(d.quality_rating),\r\n          };\r\n        })\r\n      );\r\n\r\n      Promise.all(promesas).then(function (values) {\r\n        puntos = values[0];\r\n        completaDiccionario(diccionario.filters);\r\n        completaDiccionario(diccionario.columns);\r\n        completaDiccionario(diccionario.rows);\r\n        completaOpciones(diccionario.outcomes);\r\n        opcionesMenu = setOpcionesMenu(diccionario);\r\n        puntos = _.orderBy(puntos, [\"id\"], [\"asc\"]);\r\n        window.puntos = puntos;\r\n        reset();\r\n        main();\r\n      });\r\n    }\r\n  }\r\n\r\n  function completaDiccionario(obj) {\r\n    _.each(obj, function (valor) {\r\n      completaOpciones(valor);\r\n    });\r\n  }\r\n\r\n  function completaOpciones(obj) {\r\n    if (obj.hasOwnProperty(\"menu\")) {\r\n      obj.label = obj.label || obj.menu;\r\n    }\r\n    _.each(obj.options, function (opcion) {\r\n      opcion.label = opcion.label || opcion.value;\r\n    });\r\n  }\r\n\r\n  function setOpcionesMenu(diccionario) {\r\n    var opciones = [];\r\n    _.each(diccionario, function (obj, tipo) {\r\n      _.each(obj, function (o, clave) {\r\n        var m = o.menu || null;\r\n        if (m !== null) {\r\n          opciones.push({\r\n            tipo: tipo,\r\n            clave: clave,\r\n            menu: m,\r\n            opcion: false,\r\n          });\r\n        } else {\r\n          var subopciones = o.options || null;\r\n          if (subopciones !== null) {\r\n            _.each(subopciones, function (subopcion) {\r\n              opciones.push({\r\n                tipo: tipo,\r\n                clave: clave,\r\n                menu: subopcion.label,\r\n                opcion: true,\r\n              });\r\n            });\r\n          }\r\n        }\r\n      });\r\n    });\r\n    return opciones;\r\n  }\r\n\r\n  function main() {\r\n    //tooltips.generaTooltips(gNodos.selectAll(\"circle\"));\r\n    el.removeClass(\"espera\");\r\n  }\r\n\r\n  function reset() {\r\n    //console.clear();\r\n    var opcionesFilas = getOpciones(controles.rows);\r\n    var opcionesColumnas = getOpciones(controles.columns);\r\n    filas = _.max([1, opcionesFilas.length || 0]);\r\n    columnas = _.max([1, opcionesColumnas.length || 0]);\r\n    var puntosFiltrados = filtraPuntos();\r\n    setCajas(puntosFiltrados);\r\n  }\r\n\r\n  function filtraPuntos() {\r\n    var puntosFiltrados = [];\r\n    var opcionesFiltros =\r\n      controles.filters === null ? [] : [controles.filters.value];\r\n    var opcionesFilas = _.map(getOpciones(controles.rows), \"value\");\r\n    var opcionesColumnas = _.map(getOpciones(controles.columns), \"value\");\r\n    var celdas = {};\r\n    puntosFiltrados = _.filter(puntos, function (p) {\r\n      var flagFiltros = false;\r\n      var flagColumnas = false;\r\n      var flagFilas = false;\r\n      p.matriz = {\r\n        m: 0,\r\n        n: 0,\r\n        num: null,\r\n      };\r\n\r\n      if (opcionesFiltros.length > 0) {\r\n        flagFiltros = indiceEnOpciones(\r\n          p[controles.filters.clave],\r\n          opcionesFiltros\r\n        );\r\n      } else {\r\n        flagFiltros = true;\r\n      }\r\n\r\n      if (opcionesColumnas.length > 0) {\r\n        flagColumnas = indiceEnOpciones(\r\n          p[controles.columns.clave],\r\n          opcionesColumnas\r\n        );\r\n        p.matriz.n = indiceTemporal;\r\n      } else {\r\n        flagColumnas = true;\r\n      }\r\n\r\n      if (opcionesFilas.length > 0) {\r\n        flagFilas = indiceEnOpciones(p[controles.rows.clave], opcionesFilas);\r\n        p.matriz.m = indiceTemporal;\r\n      } else {\r\n        flagFilas = true;\r\n      }\r\n\r\n      if (flagFiltros && flagColumnas && flagFilas) {\r\n        var clave = `${p.matriz.m}-${p.matriz.n}`;\r\n        if (!celdas.hasOwnProperty(clave)) {\r\n          celdas[clave] = 0;\r\n        }\r\n        p.matriz.num = celdas[clave];\r\n        celdas[clave] = celdas[clave] + 1;\r\n      }\r\n      return flagFiltros && flagColumnas && flagFilas;\r\n    });\r\n    //TODO: El nest para agrupar circulitos\r\n    /*\r\n    clonsola.log(\"puntosFiltrados (pre)\");\r\n    clonsola.log(puntosFiltrados);\r\n    puntosFiltrados = d3\r\n      .nest()\r\n      .key(function (d) {\r\n        return d.ref_id;\r\n      })\r\n      .entries(puntosFiltrados); // --> nest DESPUÉS DE FILTRAR\r\n    clonsola.log(\"puntosFiltrados (post)\");\r\n    clonsola.log(puntosFiltrados);\r\n    */\r\n    return puntosFiltrados;\r\n  }\r\n\r\n  //TODO: Esto está feo pero funciona de momento\r\n  var indiceTemporal = -1;\r\n  function indiceEnOpciones(arreglo, opciones) {\r\n    if (!Array.isArray(arreglo)) {\r\n      arreglo = [arreglo];\r\n    }\r\n    return arreglo.some(function (v) {\r\n      indiceTemporal = opciones.indexOf(v);\r\n      return indiceTemporal >= 0;\r\n    });\r\n  }\r\n\r\n  function setCajas(puntosFiltrados) {\r\n    setCajaPunto();\r\n    setCajaOutcome();\r\n    setCajaStudy();\r\n    setCajaExplicacion();\r\n    setCajaEncabezadoColumnas();\r\n    setCajaTituloFilas();\r\n    var ajusteX = cajaEncabezadoFilas.outer.width;\r\n    emparejaCajasEncabezados();\r\n    var ajusteY = cajaWrapperSuperior.outer.height;\r\n    setCajaWrapperSuperior();\r\n    setCajaEncabezadoFilas();\r\n    setCajaPuntos();\r\n    var filasMatriz = setFilasMatriz(puntosFiltrados);\r\n    emparejaFilas(filasMatriz);\r\n    var altura = filasMatriz.length > 0 ? filasMatriz[0].altura : 0;\r\n    emparejaCajaPuntos(altura);\r\n    setCajaSeparadores();\r\n    setCajaRaiz();\r\n    setSeparadores(filasMatriz);\r\n    var celdas = setCeldas(filasMatriz, puntosFiltrados);\r\n    var celdasLlenas = _.filter(celdas, function (c) {\r\n      return c.puntos.length > 0;\r\n    });\r\n    var celdasVacias = _.filter(celdas, function (c) {\r\n      return c.puntos.length <= 0;\r\n    });\r\n    setCeldasVacias(celdasVacias);\r\n    setBotonCeldasLlenas(celdasLlenas);\r\n    setPuntos({ x: ajusteX, y: ajusteY }, puntosFiltrados);\r\n  }\r\n\r\n  var cajaPunto = null;\r\n  function setCajaPunto() {\r\n    var radioCirculo =\r\n      controles.rows !== null || controles.columns !== null ? 8 : 10;\r\n    var margenCirculo =\r\n      controles.rows !== null || controles.columns !== null ? 4 : 12;\r\n    //var radioCirculo = 8;\r\n    //var margenCirculo = 4;\r\n    cajaPunto = new Box({\r\n      content: { width: radioCirculo * 2, height: radioCirculo * 2 },\r\n      margin: margenCirculo,\r\n    });\r\n  }\r\n\r\n  function setCajaOutcome() {\r\n    cajaOutcome = new Box();\r\n  }\r\n\r\n  function setCajaStudy() {\r\n    cajaStudy = new Box();\r\n  }\r\n\r\n  function setCajaExplicacion() {\r\n    cajaExplicacion = new Box();\r\n  }\r\n\r\n  function setCajaEncabezadoColumnas() {\r\n    var arregloTitulo = [];\r\n    var arregloColumnas = [];\r\n    anchoColumna = 0;\r\n    anchoColumnaTexto = 0;\r\n    var tituloColumnas = gEncabezadoColumnas\r\n      .selectAll(\"text.titulo.columna\")\r\n      .data(arregloTitulo);\r\n    var etiquetasColumnas = gEncabezadoColumnas\r\n      .selectAll(\"text.encabezado\")\r\n      .data(arregloColumnas);\r\n    tituloColumnas.exit().remove();\r\n    etiquetasColumnas.exit().remove();\r\n    if (controles.rows === null) {\r\n      anchoColumna = caja.content.width / columnas;\r\n    } else {\r\n      if (controles.columns === null) {\r\n        anchoColumna = caja.content.width;\r\n      } else {\r\n        anchoColumna = caja.content.width / (columnas + 1);\r\n      }\r\n    }\r\n    anchoColumnaTexto = anchoColumna - 2 * paddingEncabezadoH;\r\n    if (controles.columns !== null) {\r\n      var offsetX = 0;\r\n      if (controles.rows !== null) {\r\n        offsetX = anchoColumna;\r\n      }\r\n      gEncabezadoColumnas.attr(\"transform\", `translate(${offsetX},0)`);\r\n      arregloTitulo = [controles.columns];\r\n      arregloColumnas = controles.columns.options;\r\n\r\n      tituloColumnas = gEncabezadoColumnas\r\n        .selectAll(\"text.titulo.columna\")\r\n        .data(arregloTitulo);\r\n      tituloColumnas\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"class\", \"titulo columna\")\r\n        .attr(\r\n          \"transform\",\r\n          `translate(${paddingEncabezadoH},${paddingEncabezadoV})`\r\n        )\r\n        .text(function (d) {\r\n          return d.label;\r\n        })\r\n        .call(guardaBBox);\r\n\r\n      etiquetasColumnas = gEncabezadoColumnas\r\n        .selectAll(\"text.encabezado\")\r\n        .data(arregloColumnas);\r\n      etiquetasColumnas\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"class\", \"encabezado columna\")\r\n        .attr(\"transform\", function (o, i) {\r\n          return `translate(${\r\n            i * anchoColumna + paddingEncabezadoH\r\n          },${controles.columns.caja.height + 3 * paddingEncabezadoV})`;\r\n        })\r\n        .attr(\"x\", 0)\r\n        .attr(\"y\", 0)\r\n        .attr(\"dy\", 0)\r\n        .text(function (o) {\r\n          return o.label;\r\n        })\r\n        .call(wrap, anchoColumnaTexto)\r\n        .call(guardaBBox);\r\n      var max = _.max(\r\n        _.map(controles.columns.options, function (d) {\r\n          return d.caja.height;\r\n        })\r\n      );\r\n    }\r\n\r\n    var anchoCaja =\r\n      controles.columns === null\r\n        ? 0\r\n        : anchoColumna * controles.columns.options.length;\r\n    var altoCaja =\r\n      controles.columns === null\r\n        ? 0\r\n        : controles.columns.caja.height + max + 4 * paddingEncabezadoV;\r\n\r\n    cajaEncabezadoColumnas = new Box({\r\n      content: {\r\n        width: anchoCaja,\r\n        height: altoCaja,\r\n      },\r\n    });\r\n    if (debug === true) {\r\n      gEncabezadoColumnas\r\n        .select(\"rect\")\r\n        .attr(\"height\", cajaEncabezadoColumnas.content.height)\r\n        .attr(\"width\", cajaEncabezadoColumnas.content.width);\r\n    }\r\n  }\r\n\r\n  function setCajaTituloFilas() {\r\n    var arregloTitulo = [];\r\n    var tituloFilas = gTituloFilas\r\n      .selectAll(\"text.titulo.fila\")\r\n      .data(arregloTitulo);\r\n    tituloFilas.exit().remove();\r\n    if (controles.rows !== null) {\r\n      arregloTitulo = [controles.rows];\r\n      var offsetY = 0;\r\n      if (controles.columns === null) {\r\n        offsetY = paddingEncabezadoV;\r\n      } else {\r\n        offsetY = controles.columns.caja.height + paddingEncabezadoV;\r\n      }\r\n      tituloFilas = gTituloFilas\r\n        .selectAll(\"text.titulo.fila\")\r\n        .data(arregloTitulo);\r\n      tituloFilas\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"class\", \"titulo fila\")\r\n        .attr(\"transform\", `translate(${paddingEncabezadoH},${offsetY})`)\r\n        .text(function (d) {\r\n          return d.label;\r\n        })\r\n        .attr(\"x\", 0)\r\n        .attr(\"y\", 0)\r\n        .attr(\"dy\", 0)\r\n        .call(wrap, anchoColumnaTexto)\r\n        .call(guardaBBox);\r\n    }\r\n    var anchoCaja = controles.rows === null ? 0 : anchoColumna;\r\n    var altoCaja = 0;\r\n    if (controles.columns === null) {\r\n      altoCaja =\r\n        controles.rows === null\r\n          ? 0\r\n          : controles.rows.caja.height + 2 * paddingEncabezadoV;\r\n    } else {\r\n      altoCaja =\r\n        controles.rows === null\r\n          ? 0\r\n          : controles.rows.caja.height +\r\n            controles.columns.caja.height +\r\n            paddingEncabezadoV;\r\n    }\r\n    cajaTituloFilas = new Box({\r\n      content: {\r\n        width: anchoCaja,\r\n        height: altoCaja,\r\n      },\r\n    });\r\n    if (debug === true) {\r\n      gTituloFilas\r\n        .select(\"rect\")\r\n        .attr(\"height\", cajaTituloFilas.content.height)\r\n        .attr(\"width\", cajaTituloFilas.content.width);\r\n    }\r\n  }\r\n\r\n  function emparejaCajasEncabezados() {\r\n    if (controles.rows !== null && controles.columns !== null) {\r\n      var alto = 0;\r\n      var ancho = 0;\r\n      if (cajaEncabezadoColumnas.inner.height > cajaTituloFilas.inner.height) {\r\n        alto = cajaEncabezadoColumnas.inner.height;\r\n        ancho = cajaTituloFilas.inner.width;\r\n        cajaTituloFilas = new Box({\r\n          content: {\r\n            width: ancho,\r\n            height: alto,\r\n          },\r\n        });\r\n      }\r\n      if (cajaTituloFilas.inner.height > cajaEncabezadoColumnas.inner.height) {\r\n        alto = cajaTituloFilas.inner.height;\r\n        ancho = cajaEncabezadoColumnas.inner.width;\r\n        cajaEncabezadoColumnas = new Box({\r\n          content: {\r\n            width: ancho,\r\n            height: alto,\r\n          },\r\n        });\r\n      }\r\n      if (debug === true) {\r\n        gEncabezadoColumnas\r\n          .select(\"rect\")\r\n          .attr(\"height\", cajaEncabezadoColumnas.content.height)\r\n          .attr(\"width\", cajaEncabezadoColumnas.content.width);\r\n        gTituloFilas\r\n          .select(\"rect\")\r\n          .attr(\"height\", cajaTituloFilas.content.height)\r\n          .attr(\"width\", cajaTituloFilas.content.width);\r\n      }\r\n    }\r\n  }\r\n\r\n  function setCajaWrapperSuperior() {\r\n    var alto = 0;\r\n    if (cajaOutcome.inner.height !== 0 || cajaStudy.inner.height !== 0) {\r\n      alto += _.max([cajaOutcome.inner.height, cajaStudy.inner.height]);\r\n    }\r\n    if (cajaExplicacion.inner.height !== 0) {\r\n      alto += cajaExplicacion.inner.height;\r\n    }\r\n    if (\r\n      cajaTituloFilas.inner.height !== 0 ||\r\n      cajaEncabezadoColumnas.inner.height !== 0\r\n    ) {\r\n      alto += _.max([\r\n        cajaTituloFilas.inner.height,\r\n        cajaEncabezadoColumnas.inner.height,\r\n      ]);\r\n    }\r\n    var ancho = alto === 0 ? 0 : caja.content.width;\r\n    cajaWrapperSuperior = new Box({ content: { width: ancho, height: alto } });\r\n    if (debug === true) {\r\n      gWrapperSuperior\r\n        .select(\"rect\")\r\n        .attr(\"height\", cajaWrapperSuperior.content.height)\r\n        .attr(\"width\", cajaWrapperSuperior.content.width);\r\n    }\r\n  }\r\n\r\n  function setCajaEncabezadoFilas() {\r\n    var arregloFilas = [];\r\n    gEncabezadoFilas.attr(\r\n      \"transform\",\r\n      `translate(0,${cajaWrapperSuperior.outer.height})`\r\n    );\r\n    var etiquetasFilas = gEncabezadoFilas\r\n      .selectAll(\"text.encabezado\")\r\n      .data(arregloFilas);\r\n    etiquetasFilas.exit().remove();\r\n    if (controles.rows !== null) {\r\n      arregloFilas = controles.rows.options;\r\n      etiquetasFilas = gEncabezadoFilas\r\n        .selectAll(\"text.encabezado\")\r\n        .data(arregloFilas);\r\n\r\n      etiquetasFilas\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"class\", \"encabezado fila\")\r\n        .attr(\"transform\", `translate(${paddingEncabezadoH},0)`)\r\n        .text(function (d) {\r\n          return d.label;\r\n        })\r\n        .attr(\"x\", 0)\r\n        .attr(\"y\", 0)\r\n        .attr(\"dy\", 0)\r\n        .call(wrap, anchoColumnaTexto)\r\n        .call(guardaBBox)\r\n        .call(ajustaAlturaEncabezadoFilas);\r\n    }\r\n\r\n    var ancho = 0;\r\n    var alto = 0;\r\n    ancho = controles.rows === null ? 0 : anchoColumna;\r\n    if (controles.rows !== null) {\r\n      var arreglo = [];\r\n      if (controles.columns === null) {\r\n        arreglo = _.map(controles.rows.options, function (o) {\r\n          return o.box.outer.width;\r\n        });\r\n        ancho = _.max(arreglo);\r\n      }\r\n      arreglo = _.map(controles.rows.options, function (o) {\r\n        return o.box.outer.height;\r\n      });\r\n      alto = _.sum(arreglo);\r\n    }\r\n    cajaEncabezadoFilas = new Box({ content: { width: ancho, height: alto } });\r\n\r\n    if (debug === true) {\r\n      gEncabezadoFilas\r\n        .select(\"rect\")\r\n        .attr(\"height\", cajaEncabezadoFilas.content.height)\r\n        .attr(\"width\", cajaEncabezadoFilas.content.width);\r\n    }\r\n  }\r\n\r\n  function setCajaPuntos() {\r\n    cajaPuntos = new Box({\r\n      content: {\r\n        width: caja.content.width - cajaEncabezadoFilas.outer.width,\r\n        height: caja.content.height - cajaWrapperSuperior.outer.height,\r\n      },\r\n    });\r\n    gPuntos.attr(\r\n      \"transform\",\r\n      `translate(${cajaEncabezadoFilas.outer.width},${cajaWrapperSuperior.outer.height})`\r\n    );\r\n    gCeldas.attr(\r\n      \"transform\",\r\n      `translate(${cajaEncabezadoFilas.outer.width},${cajaWrapperSuperior.outer.height})`\r\n    );\r\n    gBotones.attr(\r\n      \"transform\",\r\n      `translate(${cajaEncabezadoFilas.outer.width},${cajaWrapperSuperior.outer.height})`\r\n    );\r\n\r\n    if (debug === true) {\r\n      gPuntos\r\n        .select(\"rect\")\r\n        .attr(\"height\", cajaPuntos.inner.height)\r\n        .attr(\"width\", cajaPuntos.inner.width);\r\n    }\r\n  }\r\n\r\n  //TODO: Agregar botones\r\n  function setFilasMatriz(puntosFiltrados) {\r\n    var filasMatriz = [];\r\n    var anchoCelda = cajaPuntos.outer.width / columnas;\r\n    var puntosPorFila = _.groupBy(puntosFiltrados, function (p) {\r\n      return p.matriz.m;\r\n    });\r\n    var puntosPorFilaCelda = _.min([\r\n      _.floor(anchoCelda / cajaPunto.outer.width),\r\n      maxPuntosPorFila,\r\n    ]);\r\n    var paddingCeldaH =\r\n      (anchoColumna - puntosPorFilaCelda * cajaPunto.outer.width) / 2;\r\n    var paddingCeldaV =\r\n      controles.rows === null && controles.columns === null\r\n        ? paddingCeldaH / 4\r\n        : paddingEncabezadoV;\r\n    _.each(puntosPorFila, function (arreglo, fila) {\r\n      var puntosPorColumna = _.groupBy(arreglo, function (p) {\r\n        return p.matriz.n;\r\n      });\r\n      filasMatriz.push({\r\n        fila: parseInt(fila),\r\n        puntos: _.max(_.values(puntosPorColumna)).length,\r\n        filas: _.ceil(\r\n          _.max(_.values(puntosPorColumna)).length / puntosPorFilaCelda\r\n        ),\r\n        altura:\r\n          2 * paddingCeldaV +\r\n          _.ceil(\r\n            _.max(_.values(puntosPorColumna)).length / puntosPorFilaCelda\r\n          ) *\r\n            cajaPunto.outer.height +\r\n          cajaBotones.outer.height,\r\n      });\r\n    });\r\n    _.each(puntosFiltrados, function (punto) {\r\n      var i = _.floor(punto.matriz.num / puntosPorFilaCelda);\r\n      var j = punto.matriz.num % puntosPorFilaCelda;\r\n      punto.celda = null;\r\n      punto.celda = {\r\n        i: i,\r\n        j: j,\r\n        paddingX: paddingCeldaH,\r\n        paddingY: paddingCeldaV,\r\n      };\r\n    });\r\n    return filasMatriz;\r\n  }\r\n\r\n  function emparejaFilas(filasMatriz) {\r\n    if (controles.rows !== null) {\r\n      _.each(filasMatriz, function (fila) {\r\n        var i = fila.fila;\r\n        var altura = fila.altura;\r\n        var opcion = controles.rows.options[i];\r\n        if (altura > opcion.box.outer.height) {\r\n          opcion.box = new Box({\r\n            content: {\r\n              width: opcion.box.content.width,\r\n              height: altura - 2 * paddingEncabezadoV,\r\n            },\r\n            padding: {\r\n              top: paddingEncabezadoV,\r\n              right: paddingEncabezadoH,\r\n              bottom: paddingEncabezadoV,\r\n              left: paddingEncabezadoH,\r\n            },\r\n          });\r\n        }\r\n      });\r\n      var acumulable = 0;\r\n      _.each(controles.rows.options, function (opcion) {\r\n        opcion.posicion = { y: acumulable };\r\n        acumulable += opcion.box.outer.height;\r\n      });\r\n      gEncabezadoFilas\r\n        .selectAll(\"text.encabezado\")\r\n        .attr(\"transform\", function (d) {\r\n          return `translate(${paddingEncabezadoH},${paddingEncabezadoV + d.posicion.y})`;\r\n        });\r\n      cajaEncabezadoFilas = new Box({\r\n        content: {\r\n          width: cajaEncabezadoFilas.content.width,\r\n          height: acumulable,\r\n        },\r\n      });\r\n      if (debug === true) {\r\n        gEncabezadoFilas\r\n          .select(\"rect\")\r\n          .attr(\"height\", cajaEncabezadoFilas.inner.height);\r\n      }\r\n    }\r\n  }\r\n\r\n  function emparejaCajaPuntos(altura) {\r\n    altura =\r\n      controles.rows === null ? altura : cajaEncabezadoFilas.content.height;\r\n    cajaPuntos = new Box({\r\n      content: {\r\n        width: cajaPuntos.content.width,\r\n        height: altura,\r\n      },\r\n    });\r\n    if (debug === true) {\r\n      gPuntos.select(\"rect\").attr(\"height\", cajaPuntos.outer.height);\r\n    }\r\n  }\r\n\r\n  function setCajaSeparadores() {\r\n    cajaSeparadores = new Box({\r\n      content: {\r\n        width: cajaPuntos.content.width,\r\n        height: cajaPuntos.content.height,\r\n      },\r\n    });\r\n    gSeparadores.attr(\r\n      \"transform\",\r\n      `translate(${cajaEncabezadoFilas.outer.width},${cajaWrapperSuperior.outer.height})`\r\n    );\r\n    if (debug === true) {\r\n      gSeparadores\r\n        .select(\"rect\")\r\n        .attr(\"height\", cajaSeparadores.inner.height)\r\n        .attr(\"width\", cajaSeparadores.inner.width);\r\n    }\r\n  }\r\n\r\n  function setCajaRaiz() {\r\n    caja = new Box({\r\n      content: {\r\n        width: caja.content.width,\r\n        height: cajaWrapperSuperior.outer.height + cajaPuntos.outer.height,\r\n      },\r\n      padding: 10,\r\n    });\r\n    raiz\r\n      .transition()\r\n      .ease(d3.easeQuadOut)\r\n      .duration(400)\r\n      .attr(\"viewBox\", [0, 0, caja.outer.width, caja.outer.height]);\r\n    if (debug === true) {\r\n      raiz.select(\"rect\").attr(\"height\", caja.outer.height);\r\n      svg.select(\"rect\").attr(\"height\", caja.content.height);\r\n    }\r\n  }\r\n\r\n  //TODO: Checar la separación entrelíneas hacia arriba\r\n  function setSeparadores(filasMatriz) {\r\n    //gSeparadores.selectAll(\"line\").remove();\r\n    var arreglo = [];\r\n    if (controles.rows !== null) {\r\n      arreglo = _.map(controles.rows.options, function (o) {\r\n        return o.posicion.y;\r\n      });\r\n      arreglo.push(cajaPuntos.outer.height);\r\n    }\r\n\r\n    var lineasF = gSeparadores.selectAll(\"line.fila\").data(arreglo);\r\n\r\n    lineasF\r\n      .enter()\r\n      .append(\"line\")\r\n      .attr(\"class\", \"fila\")\r\n      .attr(\"x1\", -cajaEncabezadoFilas.outer.width + paddingEncabezadoH)\r\n      .attr(\"x2\", cajaPuntos.outer.width)\r\n      .attr(\"y1\", function (d) {\r\n        return d;\r\n      })\r\n      .attr(\"y2\", function (d) {\r\n        return d;\r\n      })\r\n      .attr(\"stroke\", \"black\")\r\n      .attr(\"stroke-width\", \"1px\");\r\n\r\n    lineasF\r\n      .attr(\"x1\", -cajaEncabezadoFilas.outer.width + paddingEncabezadoH)\r\n      .attr(\"x2\", cajaPuntos.outer.width)\r\n      .attr(\"y1\", function (d) {\r\n        return d;\r\n      })\r\n      .attr(\"y2\", function (d) {\r\n        return d;\r\n      });\r\n\r\n    lineasF.exit().remove();\r\n\r\n    var arregloColumnas = [];\r\n    if (controles.columns !== null && columnas > 1) {\r\n      var j = 0;\r\n      if (controles.rows === null) {\r\n        j = 1;\r\n      }\r\n      for (j; j < columnas; j++) {\r\n        arregloColumnas.push(j);\r\n      }\r\n    }\r\n\r\n    var lineasC = gSeparadores.selectAll(\"line.columna\").data(arregloColumnas);\r\n\r\n    lineasC\r\n      .enter()\r\n      .append(\"line\")\r\n      .attr(\"class\", \"columna\")\r\n      .attr(\"x1\", function (d) {\r\n        return d * anchoColumna;\r\n      })\r\n      .attr(\"x2\", function (d) {\r\n        return d * anchoColumna;\r\n      })\r\n      .attr(\"y1\", function (d, i) {\r\n        var offset = i === 0 ? 0 : 27;\r\n        return -cajaWrapperSuperior.outer.height + paddingEncabezadoV + offset;\r\n      })\r\n      .attr(\"y2\", cajaPuntos.outer.height)\r\n      .attr(\"stroke\", \"black\")\r\n      .attr(\"stroke-width\", \"1px\");\r\n\r\n    lineasC\r\n      .attr(\"x1\", function (d) {\r\n        return d * anchoColumna;\r\n      })\r\n      .attr(\"x2\", function (d) {\r\n        return d * anchoColumna;\r\n      })\r\n      //.attr(\"y1\", -cajaWrapperSuperior.outer.height + paddingEncabezadoV)\r\n      .attr(\"y1\", function (d, i) {\r\n        var offset = i === 0 ? 0 : 27;\r\n        //offset = 0;\r\n        return -cajaWrapperSuperior.outer.height + paddingEncabezadoV + offset;\r\n      })\r\n      .attr(\"y2\", cajaPuntos.outer.height);\r\n\r\n    lineasC.exit().remove();\r\n  }\r\n\r\n  //TODO: Rechecar esto\r\n  function setCeldas(filasMatriz, puntosFiltrados) {\r\n    var puntosAgrupados = _.groupBy(puntosFiltrados, function (d) {\r\n      return `${d.matriz.m}-${d.matriz.n}`;\r\n    });\r\n\r\n    var arreglo = [];\r\n    if (controles.rows !== null) {\r\n      arreglo = _.map(controles.rows.options, function (o) {\r\n        return o.posicion.y;\r\n      });\r\n    }\r\n\r\n    var arregloAlturas = [];\r\n    if (controles.rows !== null) {\r\n      arregloAlturas = _.map(controles.rows.options, function (o) {\r\n        return o.posicion.y;\r\n      });\r\n      arregloAlturas.push(cajaPuntos.outer.height);\r\n    } else {\r\n      arregloAlturas.push(0);\r\n      arregloAlturas.push(cajaPuntos.outer.height);\r\n    }\r\n\r\n    var m = 0;\r\n    var n = 0;\r\n    var clave = null;\r\n    var puntos = null;\r\n    var x = null;\r\n    var y = null;\r\n    var width = null;\r\n    var height = null;\r\n    var celdas = [];\r\n    for (m = 0; m < filas; m++) {\r\n      for (n = 0; n < columnas; n++) {\r\n        clave = `${m}-${n}`;\r\n        x = n * anchoColumna;\r\n        y = arreglo[m] || 0;\r\n        width = anchoColumna;\r\n        height = arregloAlturas[m + 1] || 0;\r\n        puntos = puntosAgrupados[clave] || [];\r\n        celdas.push({\r\n          m: m,\r\n          n: n,\r\n          puntos: puntos,\r\n          coordenadas: { x: x, y: y },\r\n          medidas: { ancho: width, alto: height - y },\r\n        });\r\n      }\r\n    }\r\n    return celdas;\r\n  }\r\n\r\n  function setCeldasVacias(celdas) {\r\n    var rects = gCeldas.selectAll(\"rect\").data(celdas);\r\n    rects\r\n      .enter()\r\n      .append(\"rect\")\r\n      .attr(\"class\", \"vacia\")\r\n      .attr(\"transform\", function (d) {\r\n        return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n      })\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", 0)\r\n      .attr(\"width\", function (d) {\r\n        return d.medidas.ancho;\r\n      })\r\n      .attr(\"height\", function (d) {\r\n        return d.medidas.alto;\r\n      });\r\n\r\n    rects\r\n      .attr(\"transform\", function (d) {\r\n        return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n      })\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", 0)\r\n      .attr(\"width\", function (d) {\r\n        return d.medidas.ancho;\r\n      })\r\n      .attr(\"height\", function (d) {\r\n        return d.medidas.alto;\r\n      });\r\n\r\n    rects.exit().remove();\r\n\r\n    gCeldas.selectAll(\"text.vacia\").data([]).exit().remove();\r\n\r\n    var textos = gCeldas.selectAll(\"text.vacia\").data(celdas);\r\n\r\n    textos\r\n      .enter()\r\n      .append(\"text\")\r\n      .attr(\"class\", \"vacia\")\r\n      .attr(\"transform\", function (d) {\r\n        return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n      })\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", 0)\r\n      .attr(\"dy\", 0)\r\n      .text(\"No studies in this category\")\r\n      .call(wrap, anchoColumnaTexto)\r\n      .call(guardaBBox)\r\n      .call(ajustaTextoCeldaVacia);\r\n\r\n    //textos.exit().remove();\r\n  }\r\n\r\n  //TODO: Asignar el evento al click de la celda/botón\r\n  //TODO: Rechecar esto porque tampoco quedó chido cuando no hay nada seleccionado\r\n  function setBotonCeldasLlenas(celdas) {\r\n    if (controles.rows !== null || controles.columns !== null) {\r\n      cajaBotones = new Box({\r\n        content: { width: anchoColumna, height: cajaBotones.content.height },\r\n        padding: cajaBotones.padding,\r\n      });\r\n\r\n      var botones = gBotones.selectAll(\"circle.boton\").data(celdas);\r\n\r\n      botones\r\n        .enter()\r\n        .append(\"circle\")\r\n        .attr(\"class\", \"boton\")\r\n        .attr(\"transform\", function (d) {\r\n          return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n        })\r\n        .attr(\"r\", cajaBotones.content.height / 2)\r\n        .attr(\"cx\", anchoColumna / 2)\r\n        .attr(\"cy\", function (d) {\r\n          return d.medidas.alto - cajaBotones.outer.height / 2;\r\n        })\r\n        .on(\"click\", function (d) {\r\n          var ids = _.map(d.puntos, \"ref_id\");\r\n          $(\"body\").trigger(\"lista:mostrar\", [ids]);\r\n        });\r\n\r\n      botones\r\n        .attr(\"transform\", function (d) {\r\n          return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n        })\r\n        .attr(\"cx\", anchoColumna / 2)\r\n        .attr(\"cy\", function (d) {\r\n          return d.medidas.alto - cajaBotones.outer.height / 2;\r\n        });\r\n\r\n      botones.exit().remove();\r\n\r\n      var tamanioLista = cajaBotones.outer.height * 0.6;\r\n      var listas = gBotones.selectAll(\"image.boton\").data(celdas);\r\n      listas\r\n        .enter()\r\n        .append(\"svg:image\")\r\n        .attr(\"class\", \"boton\")\r\n        .attr(\"transform\", function (d) {\r\n          return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n        })\r\n        .attr(\"x\", (anchoColumna - tamanioLista) / 2)\r\n        .attr(\"y\", function (d) {\r\n          return (\r\n            d.medidas.alto - cajaBotones.outer.height / 2 - tamanioLista / 2\r\n          );\r\n        })\r\n        .attr(\"width\", tamanioLista)\r\n        .attr(\"height\", tamanioLista)\r\n        .attr(\"xlink:href\", \"img/export.svg\");\r\n\r\n      listas\r\n        .attr(\"transform\", function (d) {\r\n          return `translate(${d.coordenadas.x},${d.coordenadas.y})`;\r\n        })\r\n        .attr(\"x\", (anchoColumna - tamanioLista) / 2)\r\n        .attr(\"y\", function (d) {\r\n          return (\r\n            d.medidas.alto - cajaBotones.outer.height / 2 - tamanioLista / 2\r\n          );\r\n        });\r\n\r\n      listas.exit().remove();\r\n    } else {\r\n      gBotones.selectAll(\"circle.boton\").data([]).exit().remove();\r\n      gBotones.selectAll(\"image.boton\").data([]).exit().remove();\r\n    }\r\n  }\r\n\r\n  //TODO:Rehacer toda esta pate porque yuck\r\n  function setPuntos(anteriores, puntosFiltrados) {\r\n    var color = \"#9595b4\";\r\n    var orden = 0;\r\n    if (controles.rows !== null) {\r\n      _.each(puntosFiltrados, function (p) {\r\n        var opcion = controles.rows.options[p.matriz.m];\r\n        var clave = opcion.key;\r\n        var valor = p[clave] || null;\r\n        if (valor !== null) {\r\n          var valor = limpiaCadena(p[clave]).toLowerCase();\r\n          switch (valor) {\r\n            case \"positive\":\r\n              color = \"#1919D0\";\r\n              orden = 1;\r\n              break;\r\n            case \"negative\":\r\n              color = \"#f78989\";\r\n              orden = 2;\r\n              break;\r\n            case \"mixed results\":\r\n              color = \"#e633da\";\r\n              orden = 3;\r\n              break;\r\n            case \"no effect\":\r\n            case \"no significant difference\":\r\n              color = \"#cdcdcd\";\r\n              orden = 4;\r\n              break;\r\n            default:\r\n              orden = 5;\r\n              break;\r\n          }\r\n        }\r\n        p.color = color;\r\n        p.orden = orden;\r\n      });\r\n\r\n      //TODO: Lo del reorden por color está acá\r\n      puntosFiltrados.sort(function (a, b) {\r\n        return a.orden - b.orden;\r\n      });\r\n      var celdas = {};\r\n      _.each(puntosFiltrados, function (p) {\r\n        var clave = `${p.matriz.m}-${p.matriz.n}`;\r\n        if (!celdas.hasOwnProperty(clave)) {\r\n          celdas[clave] = 0;\r\n        }\r\n        p.matriz.num = celdas[clave];\r\n        celdas[clave] = celdas[clave] + 1;\r\n      });\r\n\r\n      var anchoCelda = cajaPuntos.outer.width / columnas;\r\n      var puntosPorFilaCelda = _.min([\r\n        _.floor(anchoCelda / cajaPunto.outer.width),\r\n        maxPuntosPorFila,\r\n      ]);\r\n      var paddingCeldaH =\r\n        (anchoColumna - puntosPorFilaCelda * cajaPunto.outer.width) / 2;\r\n      var paddingCeldaV =\r\n        controles.rows === null && controles.columns === null\r\n          ? paddingCeldaH / 4\r\n          : paddingEncabezadoV;\r\n\r\n      _.each(puntosFiltrados, function (punto) {\r\n        var i = _.floor(punto.matriz.num / puntosPorFilaCelda);\r\n        var j = punto.matriz.num % puntosPorFilaCelda;\r\n        punto.celda = null;\r\n        punto.celda = {\r\n          i: i,\r\n          j: j,\r\n          paddingX: paddingCeldaH,\r\n          paddingY: paddingCeldaV,\r\n        };\r\n      });\r\n    } else {\r\n      _.each(puntosFiltrados, function (p) {\r\n        p.color = color;\r\n        p.orden = 0;\r\n      });\r\n    }\r\n\r\n    //TODO: Acá abajo está chido, lo que se agregó para colores es lo de arribita\r\n    var actuales = {\r\n      x: cajaEncabezadoFilas.outer.width,\r\n      y: cajaWrapperSuperior.outer.height,\r\n    };\r\n    var offsetX = actuales.x - anteriores.x;\r\n    var offsetY = actuales.y - anteriores.y;\r\n\r\n    setCajaPunto();\r\n\r\n    var circulos = gPuntos\r\n      .selectAll(\"circle.study_dots\")\r\n      .data(puntosFiltrados, function (d) {\r\n        return d.id;\r\n      });\r\n\r\n    circulos\r\n      .enter()\r\n      .each(function (d) {\r\n        d.coordenadas = { x: calculaPosicionX(d), y: calculaPosicionY(d) };\r\n        d.anteriores = { x: 0, y: 0 };\r\n      })\r\n      .append(\"circle\")\r\n      .attr(\"id\", function (d) {\r\n        return `study_${d.ref_id}`;\r\n      })\r\n      .attr(\"class\", \"study_dots\")\r\n      .attr(\"fill\", function (d) {\r\n        return d.color;\r\n      })\r\n      .attr(\"r\", 0)\r\n      .attr(\"cx\", function (d) {\r\n        return d.coordenadas.x;\r\n      })\r\n      .attr(\"cy\", function (d) {\r\n        return d.coordenadas.y;\r\n      })\r\n      .on(\"click\", function (d) {\r\n        $(\"body\").trigger(\"articulo:mostrar\", [d.ref_id]);\r\n      })\r\n      .transition()\r\n      .ease(d3.easeQuadOut)\r\n      .duration(400)\r\n      .attr(\"r\", cajaPunto.content.width / 2);\r\n\r\n    circulos\r\n      .attr(\"cx\", function (d) {\r\n        d.coordenadas.x = d.coordenadas.x - offsetX;\r\n        d.anteriores.x = d.coordenadas.x;\r\n        return d.coordenadas.x;\r\n      })\r\n      .attr(\"cy\", function (d) {\r\n        d.coordenadas.y = d.coordenadas.y - offsetY;\r\n        d.anteriores.y = d.coordenadas.y;\r\n        return d.coordenadas.y;\r\n      })\r\n      .transition()\r\n      .ease(d3.easeQuadOut)\r\n      .duration(400)\r\n      .attr(\"r\", cajaPunto.content.width / 2)\r\n      .attr(\"fill\", function (d) {\r\n        return d.color;\r\n      })\r\n      .attr(\"cx\", function (d) {\r\n        d.coordenadas.x = calculaPosicionX(d);\r\n        return d.coordenadas.x;\r\n      })\r\n      .attr(\"cy\", function (d) {\r\n        d.coordenadas.y = calculaPosicionY(d);\r\n        return d.coordenadas.y;\r\n      });\r\n\r\n    circulos\r\n      .exit()\r\n      .attr(\"cx\", function (d) {\r\n        d.coordenadas.x = d.coordenadas.x - offsetX;\r\n        return d.coordenadas.x;\r\n      })\r\n      .attr(\"cy\", function (d) {\r\n        d.coordenadas.y = d.coordenadas.y - offsetY;\r\n        return d.coordenadas.y;\r\n      })\r\n      .transition()\r\n      .ease(d3.easeQuadOut)\r\n      .duration(400)\r\n      .attr(\"fill\", function (d) {\r\n        return d.color;\r\n      })\r\n      .attr(\"r\", 0)\r\n      .remove();\r\n\r\n    if (controles.switch === null) {\r\n      gPuntos\r\n        .selectAll(\"image\")\r\n        .data([], function (d) {\r\n          return d.id;\r\n        })\r\n        .exit()\r\n        .remove();\r\n    } else {\r\n      var tamanioBarras =\r\n        controles.rows !== null || controles.columns !== null\r\n          ? cajaPunto.outer.height * 0.5\r\n          : cajaPunto.outer.height * 0.3;\r\n\r\n      var barras = gPuntos\r\n        .selectAll(\"image.quality\")\r\n        .data(puntosFiltrados, function (d) {\r\n          return d.id;\r\n        });\r\n\r\n      barras\r\n        .enter()\r\n        .append(\"svg:image\")\r\n        .attr(\"class\", \"quality\")\r\n        .attr(\"x\", function (d) {\r\n          return d.coordenadas.x;\r\n        })\r\n        .attr(\"y\", function (d) {\r\n          return d.coordenadas.y;\r\n        })\r\n        .attr(\"width\", 0)\r\n        .attr(\"height\", 0)\r\n        .attr(\"xlink:href\", function (d) {\r\n          var clave = controles.switch.clave;\r\n          var nombre = d[clave].toLowerCase();\r\n          return `img/${nombre}.svg`;\r\n        })\r\n        .transition()\r\n        .ease(d3.easeQuadOut)\r\n        .duration(400)\r\n        .attr(\"x\", function (d) {\r\n          return d.coordenadas.x - tamanioBarras / 2;\r\n        })\r\n        .attr(\"y\", function (d) {\r\n          return d.coordenadas.y - tamanioBarras / 2;\r\n        })\r\n        .attr(\"width\", tamanioBarras)\r\n        .attr(\"height\", tamanioBarras);\r\n\r\n      barras\r\n        .attr(\"x\", function (d) {\r\n          return d.anteriores.x - tamanioBarras / 2;\r\n        })\r\n        .attr(\"y\", function (d) {\r\n          return d.anteriores.y - tamanioBarras / 2;\r\n        })\r\n        .transition()\r\n        .ease(d3.easeQuadOut)\r\n        .duration(400)\r\n        .attr(\"x\", function (d) {\r\n          return d.coordenadas.x - tamanioBarras / 2;\r\n        })\r\n        .attr(\"y\", function (d) {\r\n          return d.coordenadas.y - tamanioBarras / 2;\r\n        })\r\n        .attr(\"width\", tamanioBarras)\r\n        .attr(\"height\", tamanioBarras);\r\n\r\n      barras.exit().remove();\r\n    }\r\n  }\r\n\r\n  function calculaPosicionX(d) {\r\n    var ancho = anchoColumna || cajaPuntos.content.width;\r\n    return (\r\n      ancho * d.matriz.n +\r\n      d.celda.j * cajaPunto.outer.width +\r\n      cajaPunto.outer.width / 2 +\r\n      d.celda.paddingX\r\n    );\r\n  }\r\n\r\n  function calculaPosicionY(d) {\r\n    var altura =\r\n      controles.rows === null\r\n        ? 0\r\n        : controles.rows.options[d.matriz.m].posicion.y;\r\n    return (\r\n      altura +\r\n      d.celda.i * cajaPunto.outer.height +\r\n      cajaPunto.outer.height / 2 +\r\n      d.celda.paddingY\r\n    );\r\n  }\r\n\r\n  function guardaBBox(opciones) {\r\n    opciones.each(function (o) {\r\n      var text = d3.select(this);\r\n      o.caja = text.node().getBBox();\r\n    });\r\n  }\r\n\r\n  function ajustaAlturaEncabezadoFilas(opciones) {\r\n    var offsetY = 0;\r\n    opciones.each(function (o, i) {\r\n      var text = d3.select(this);\r\n      o.box = new Box({\r\n        content: { width: o.caja.width, height: o.caja.height },\r\n        padding: {\r\n          top: paddingEncabezadoV,\r\n          right: paddingEncabezadoH,\r\n          bottom: paddingEncabezadoV,\r\n          left: paddingEncabezadoH,\r\n        },\r\n      });\r\n      text.attr(\r\n        \"transform\",\r\n        `translate(${paddingEncabezadoH},${offsetY + paddingEncabezadoV})`\r\n      );\r\n      offsetY += o.box.outer.height;\r\n    });\r\n  }\r\n\r\n  function ajustaTextoCeldaVacia(textos) {\r\n    textos.each(function (t, i) {\r\n      var text = d3.select(this);\r\n      var anchoTexto = t.caja.width;\r\n      var altoTexto = t.caja.height;\r\n      var anchoCaja = t.medidas.ancho;\r\n      var altoCaja = t.medidas.alto;\r\n      var offsetX = (anchoCaja - anchoTexto) / 2;\r\n      var offsetY = (altoCaja - altoTexto) / 2;\r\n      text.attr(\r\n        \"transform\",\r\n        `translate(${t.coordenadas.x + offsetX},${t.coordenadas.y + offsetY})`\r\n      );\r\n    });\r\n  }\r\n\r\n  function getOpciones(obj) {\r\n    obj = obj || null;\r\n    var arreglo = [];\r\n    if (obj !== null) {\r\n      arreglo = obj.options;\r\n    }\r\n    return arreglo;\r\n  }\r\n\r\n  //TODO: Checar que tranza entre label vs value con Early childhood education and development\r\n  function setMenu(menu) {\r\n    var opcion = _.find(opcionesMenu, { menu: menu }) || null;\r\n    if (opcion !== null) {\r\n      var obj = null;\r\n      var tipo = opcion.tipo;\r\n      var clave = opcion.clave;\r\n      var opc = opcion.opcion;\r\n      if (opc === true) {\r\n        var arreglo = diccionario[tipo][clave].options;\r\n        obj = _.find(arreglo, { value: menu }) || null;\r\n      } else {\r\n        obj = diccionario[tipo][clave];\r\n      }\r\n      obj.tipo = tipo;\r\n      obj.clave = clave;\r\n      obj.opcion = opc;\r\n      controles[tipo] = obj;\r\n    }\r\n    reset();\r\n  }\r\n\r\n  function unsetMenu(menu) {\r\n    var opcion = _.find(opcionesMenu, { menu: menu }) || null;\r\n    if (opcion !== null) {\r\n      var tipo = opcion.tipo;\r\n      if (opcion.opcion === true) {\r\n        if (controles[tipo] !== null) {\r\n          if (controles[tipo].label == menu) {\r\n            controles[tipo] = null;\r\n          }\r\n        }\r\n      } else {\r\n        if (controles[tipo] !== null) {\r\n          if (controles[tipo].menu == menu) {\r\n            controles[tipo] = null;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    reset();\r\n  }\r\n\r\n  function limpiaCadena(cadena) {\r\n    cadena = _.trim(cadena);\r\n    return cadena == \"\" ? null : cadena;\r\n  }\r\n\r\n  function convierteCadenaAArreglo(cadena, ajustarOtro) {\r\n    var coma = /,\\s+/g;\r\n    var barra = /\\|/g;\r\n    var arreglo = [];\r\n    cadena = _.trim(cadena);\r\n    ajustarOtro = ajustarOtro || false;\r\n    if (cadena != \"\") {\r\n      arreglo = cadena\r\n        .replace(coma, \"|\")\r\n        .split(\",\")\r\n        .map(function (c) {\r\n          return c.replace(barra, \", \");\r\n        });\r\n    }\r\n    if (ajustarOtro === true) {\r\n      var er = /other/i;\r\n      arreglo = arreglo.map(function (c) {\r\n        if (er.test(c)) {\r\n          c = \"Other\";\r\n        }\r\n        return c;\r\n      });\r\n    }\r\n    return arreglo;\r\n  }\r\n\r\n  function convierteCadenaABooleano(cadena) {\r\n    cadena = _.trim(cadena);\r\n    return _.lowerCase(cadena) == \"yes\" ? true : false;\r\n  }\r\n\r\n  function convierteCadenaAResultados(cadena, diccionario) {\r\n    cadena = _.trim(cadena);\r\n    var opciones = diccionario.options;\r\n    var valor = cadena;\r\n    cadena = null;\r\n    var opcion = _.find(opciones, function (o) {\r\n      return o.value == valor ? true : false;\r\n    });\r\n    opcion = opcion || false;\r\n    if (opcion !== false) {\r\n      cadena = opcion.value;\r\n    }\r\n    return cadena;\r\n  }\r\n\r\n  function convierteCadenaARangos(cadena, diccionario) {\r\n    cadena = _.trim(cadena);\r\n    var opciones = diccionario.options;\r\n    var valor = parseFloat(cadena);\r\n    cadena = \"NR\";\r\n    if (!isNaN(valor)) {\r\n      var opcion = _.find(opciones, function (o) {\r\n        return o.range[0] <= valor && valor <= o.range[1] ? true : false;\r\n      });\r\n      opcion = opcion || false;\r\n      if (opcion !== false) {\r\n        cadena = opcion.value;\r\n      }\r\n    }\r\n    return cadena;\r\n  }\r\n\r\n  setup();\r\n\r\n  //Tomada de https://bl.ocks.org/mbostock/7555321\r\n  function wrap(text, width) {\r\n    text.each(function () {\r\n      var text = d3.select(this),\r\n        words = text.text().split(/\\s+/).reverse(),\r\n        word,\r\n        line = [],\r\n        lineNumber = 0,\r\n        lineHeight = 1.1, // ems\r\n        y = text.attr(\"y\"),\r\n        dy = parseFloat(text.attr(\"dy\")),\r\n        tspan = text\r\n          .text(null)\r\n          .append(\"tspan\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"y\", y)\r\n          .attr(\"dy\", dy + \"em\");\r\n      while ((word = words.pop())) {\r\n        line.push(word);\r\n        tspan.text(line.join(\" \"));\r\n        if (tspan.node().getComputedTextLength() > width) {\r\n          line.pop();\r\n          tspan.text(line.join(\" \"));\r\n          line = [word];\r\n          tspan = text\r\n            .append(\"tspan\")\r\n            .attr(\"x\", 0)\r\n            .attr(\"y\", y)\r\n            .attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\")\r\n            .text(word);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  return {\r\n    reset: reset,\r\n    setMenu: setMenu,\r\n    unsetMenu: unsetMenu,\r\n  };\r\n};\r\n","$(function () {\r\n  var elementos = [];\r\n\r\n  function getGUID() {\r\n    return (\r\n      Date.now().toString(36) + Math.random().toString(36).substr(2, 5)\r\n    ).toUpperCase();\r\n  }\r\n\r\n  function main() {\r\n    elementos = $(\".contenedor-visualizacion\");\r\n    elementos.addClass(\"espera\");\r\n    _.each(elementos, function (el, i) {\r\n      el = $(el);\r\n      var tipo = el.data(\"tipo-visualizacion\");\r\n      window.v = getVisualizacion(el, i, tipo);\r\n      $(\"#reset\").click(function () {\r\n        window.v.reset();\r\n      });\r\n      $(\"#matriz1x3\").click(function () {\r\n        window.v.matriz1x3();\r\n      });\r\n      $(\"#matriz2x2\").click(function () {\r\n        window.v.matriz2x2();\r\n      });\r\n      $(\"#matriz2x3\").click(function () {\r\n        window.v.matriz2x3();\r\n      });\r\n      $(\"#matriz1x5\").click(function () {\r\n        window.v.matriz1x5();\r\n      });\r\n    });\r\n  }\r\n\r\n  function getVisualizacion(elemento, i, tipo) {\r\n    var v = null;\r\n    switch (tipo) {\r\n      case \"puntos\":\r\n        v = new Puntos(elemento, i);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    return v;\r\n  }\r\n\r\n  main();\r\n});\r\n"]}